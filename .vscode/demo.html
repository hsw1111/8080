<template>
    <!--单车日营收-->
     <div class="fiexedAssets">
          <Table id="fiexedAssets" min-width="1180" height="420" border :columns="columns2" :data="data4"></Table>
     </div>
   </template>
   <script>
   import { mapGetters } from 'vuex'
   import $ from 'jquery'
       export default {
           data () {
               return {
                   columns2: [
                       {
                           title: '城市',
                           key: 'name',
                           width: 100,
                           fixed: 'left',
                           className: 'middle',
                           render: (h, params) => {
                               return h('div', params.row.cityName)
                           },
                           renderHeader: (h, params) => {
                               return h('div', [
                                   h('div', {
                                       style: {
                                           width: '100%',
                                       }
                                   }, '城市'),
   
                               ])
                           }
                       },
                       {
                           title: '单车产出',
                           key: 'age',
                           width: 420,
                           align: 'center',
                           render: (h, params) => {
                               return h('div', {
                                   style: {
                                       height: '30px'
                                   }
                               }, [
                                       h('span', {
                                           style: {
                                               float: 'left',
                                               width: '50%',
                                               height: '30px',
                                               lineHeight: '30px',
                                               borderRight: '1px solid rgb(233, 234, 236)',
                                               boxSizing: 'border-box',
                                           }
                                       }, params.row.singleProduce.outPutBilling),
                                       h('span', {
                                           style: {
                                               float: 'left',
                                               width: '50%',
                                               height: '30px',
                                               lineHeight: '30px',
                                               borderRight: 'none',
                                               boxSizing: 'border-box',
                                           }
                                       }, params.row.singleProduce.outPutReality)
   
                                   ])
                           },
                           renderHeader: (h, params) => {
                               return h('div', [
                                   h('div', {
                                       style: {
                                           width: '100%',
                                           lineHeight: '30px',
   
                                       }
                                   }, '单车产出'),
                                   h('div', {
                                       style: {
                                           width: '100%',
                                           lineHeight: '30px',
                                           borderBottom: '1px solid #e9eaec '
                                       }
                                   }, [
                                           h('span', {
                                               style: {
                                                   float: 'left',
                                                   width: '50%',
                                                   borderRight: '1px solid rgb(233, 234, 236)',
                                                   boxSizing: 'border-box',
                                               }
                                           }, '计费'),
                                           h('span', {
                                               style: {
                                                   float: 'left',
                                                   width: '50%',
                                                   borderRight: 'none',
                                                   boxSizing: 'border-box',
                                               }
                                           }, '实收')
                                       ])
                               ])
                           }
                       },
                       {
                           title: '单车成本',
                           key: 'age',
                           width: 420,
                           align: 'center',
                           render: (h, params) => {
                               return h('div', {
                                   style: {
                                       height: '30px'
                                   }
                               }, [
   
                                       h('span', {
                                           style: {
                                               float: 'left',
                                               width: '100%',
                                               height: '30px',
                                               lineHeight: '30px',
                                               boxSizing: 'border-box',
                                           }
                                       }, params.row.singleCost.oBikeCost)
   
                                   ])
                           },
                           renderHeader: (h, params) => {
                               return h('div', [
                                   h('div', {
                                       style: {
                                           width: '100%',
                                           lineHeight: '60px',
                                       }
                                   }, '单车成本'),
                                   h('div', {
                                       style: {
                                           width: '100%',
                                           lineHeight: '30px',
                                       }
                                   }, [
   
   
                                       ])
                               ])
                           }
                       },
                       {
                           title: '单车盈收',
                           key: 'age',
                           width: 420,
                           align: 'center',
                           render: (h, params) => {
                               return h('div', {
                                   style: {
                                       height: '30px'
                                   }
                               }, [
                                       h('span', {
                                           style: {
                                               float: 'left',
                                               width: '50%',
                                               height: '30px',
                                               lineHeight: '30px',
                                               borderRight: '1px solid rgb(233, 234, 236)',
                                               boxSizing: 'border-box',
                                           }
                                       }, params.row.singleProfit.inPutBilling),
                                       h('span', {
                                           style: {
                                               float: 'left',
                                               width: '50%',
                                               height: '30px',
                                               lineHeight: '30px',
                                               borderRight: 'none',
                                               boxSizing: 'border-box',
                                           }
                                       }, params.row.singleProfit.inPutReality)
   
                                   ])
                           },
                           renderHeader: (h, params) => {
                               return h('div', [
                                   h('div', {
                                       style: {
                                           width: '100%',
                                           lineHeight: '30px',
                                           borderBottom: 'none',
                                       }
                                   }, '单车盈收'),
                                   h('div', {
                                       style: {
                                           width: '100%',
                                           lineHeight: '30px',
                                           borderBottom: '1px solid #e9eaec '
                                       }
                                   }, [
                                           h('span', {
                                               style: {
                                                   float: 'left',
                                                   width: '50%',
                                                   borderRight: 'none',
                                                   boxSizing: 'border-box',
                                               }
                                           }, '计费'),
                                           h('span', {
                                               style: {
                                                   float: 'left',
                                                   width: '50%',
                                                   borderRight: 'none',
                                                   boxSizing: 'border-box',
                                               }
                                           }, '实收')
                                       ])
                               ])
                           }
                       },
                       {
                           title: '单车盈收率）',
                           key: 'age',
                           width: 420,
                           align: 'center',
                           render: (h, params) => {
                               return h('div', {
                                   style: {
                                       height: '30px'
                                   }
                               }, [
                                       h('span', {
                                           style: {
                                               float: 'left',
                                               width: '50%',
                                               height: '30px',
                                               lineHeight: '30px',
                                               borderRight: '1px solid rgb(233, 234, 236)',
                                               boxSizing: 'border-box',
                                           }
                                       }, params.row.singleProfitRate.inPutBillingLv),
                                       h('span', {
                                           style: {
                                               float: 'left',
                                               width: '50%',
                                               height: '30px',
                                               lineHeight: '30px',
                                               borderRight: 'none',
                                               boxSizing: 'border-box',
                                           }
                                       }, params.row.singleProfitRate.inPutRealityLv),
                                   ])
                           },
                           renderHeader: (h, params) => {
                               return h('div', [
                                   h('div', {
                                       style: {
                                           width: '100%',
                                           lineHeight: '30px',
                                           borderBottom: 'none ',
                                       }
                                   }, '单车盈收率'),
                                   h('div', {
                                       style: {
                                           width: '100%',
                                           lineHeight: '30px',
                                           borderBottom: '1px solid #e9eaec '
                                       }
                                   }, [
                                           h('span', {
                                               style: {
                                                   float: 'left',
                                                   width: '50%',
                                                   borderRight: '1px solid rgb(233, 234, 236)',
                                                   boxSizing: 'border-box',
                                               }
                                           }, '计费'),
                                           h('span', {
                                               style: {
                                                   float: 'left',
                                                   width: '50%',
                                                   borderRight: 'none',
                                                   boxSizing: 'border-box',
                                               }
                                           }, '实收')
                                       ])
                               ])
                           }
                       },
                       
                       // {
                       //     title: '盈亏状态（实收）',
                       //     key: 'age',
                       //     width: 420,
                       //     align: 'center',
                       //     render: (h, params) => {
                       //         return h('div', {
                       //             style: {
                       //                 height: '30px'
                       //             }
                       //         }, [
                       //                 h('span', {
                       //                     style: {
                       //                         float: 'left',
                       //                         width: '50%',
                       //                         height: '30px',
                       //                         lineHeight: '30px',
                       //                         borderRight: '1px solid rgb(233, 234, 236)',
                       //                         boxSizing: 'border-box',
                       //                     }
                       //                 }, params.row.beefly.num),
                       //                 h('span', {
                       //                     style: {
                       //                         float: 'left',
                       //                         width: '50%',
                       //                         height: '30px',
                       //                         lineHeight: '30px',
                       //                         borderRight: 'none',
                       //                         boxSizing: 'border-box',
                       //                     }
                       //                 }, params.row.beefly.money),
                       //             ])
                       //     },
                       //     renderHeader: (h, params) => {
                       //         return h('div', [
                       //             h('div', {
                       //                 style: {
                       //                     width: '100%',
                       //                     lineHeight: '30px',
                       //                     borderBottom: 'none ',
                       //                 }
                       //             }, '盈亏状态（实收）'),
                       //             h('div', {
                       //                 style: {
                       //                     width: '100%',
                       //                     lineHeight: '30px',
                       //                     borderBottom: '1px solid #e9eaec '
                       //                 }
                       //             }, [
                       //                     h('span', {
                       //                         style: {
                       //                             float: 'left',
                       //                             width: '50%',
                       //                             borderRight: '1px solid rgb(233, 234, 236)',
                       //                             boxSizing: 'border-box',
                       //                         }
                       //                     }, '实收盈亏'),
                       //                     h('span', {
                       //                         style: {
                       //                             float: 'left',
                       //                             width: '50%',
                       //                             borderRight: 'none',
                       //                             boxSizing: 'border-box',
                       //                         }
                       //                     }, '实收盈亏率')
                       //                 ])
                       //         ])
                       //     }
                       // },
                       // {
                       //     title: '单车产出',
                       //     key: 'age',
                       //     width: 420,
                       //     align:'center',
                       //     render:(h,params)=>{
                       //         return  h('div',{
                       //            style:{
                       //                 height:'30px'
                       //            }
                       //         },[
                       //                 h('span',{
                       //                     style:{
                       //                         float:'left',
                       //                        width:'50%',
                       //                         height:'30px',
                       //                         lineHeight:'30px',
                       //                         borderRight:'1px solid rgb(233, 234, 236)',
                       //                         boxSizing:'border-box',
                       //                     }
                       //                 },params.row.beefly.num),
                       //                 h('span',{
                       //                     style:{
                       //                         float:'left',
                       //                        width:'50%',
                       //                         height:'30px',
                       //                         lineHeight:'30px',
                       //                         borderRight:'none',
                       //                         boxSizing:'border-box',
                       //                     }
                       //                 },params.row.beefly.money),
                       //             ])
                       //     },
                       //     renderHeader:(h,params)=>{
                       //         return h('div',[
                       //             h('div',{
                       //                  style:{
                       //                     width:'100%',
                       //                     lineHeight:'30px',
                       //                     borderBottom:'none ',
                       //                 }
                       //             },'单车产出'),
                       //             h('div',{
                       //                style:{
                       //                     width:'100%',
                       //                     lineHeight:'30px',
                       //                     borderBottom:'1px solid #e9eaec '
                       //                 } 
                       //             },[
                       //                 h('span',{
                       //                     style:{
                       //                         float:'left',
                       //                        width:'50%',
                       //                         borderRight:'1px solid rgb(233, 234, 236)',
                       //                         boxSizing:'border-box',
                       //                     }
                       //                 },'计费'),
                       //                 h('span',{
                       //                     style:{
                       //                         float:'left',
                       //                         width:'50%',
                       //                         borderRight:'none',
                       //                         boxSizing:'border-box',
                       //                     }
                       //                 },'实收')
                       //             ])
                       //         ])
                       //     }
                       // },
                       //  {
                       //     title: '合计',
                       //     key: 'total',
                       //     width: 100,
                       //     fixed: 'right',
                       //     className:'middle',
                       //      render:(h,params)=>{
                       //         return h('div',params.row.total.money)
                       //     },
                       //     renderHeader:(h,params)=>{
                       //         return h('div',[
                       //             h('div',{
                       //                 style:{
                       //                     width:'100%',
                                          
                       //                 }
                       //             },'合计')
                                  
                       //         ])
                       //     }
                       // }
                   ],
                   data4:this.mockTableData(),
                   countObj:{}
               }
           },
           computed:{
               ...mapGetters(['dataMonth'])
           },
           methods:{
               mockTableData(){
                   let data = [];
                   for(let i=0;i<11;i++){
                       data.push(
                            {
                               cityName: '城市' + Math.floor(Math.random () * 100 + 1),
                               singleProduce:{
                                   outPutBilling:Math.floor(Math.random () * 3 + 1),//单车产出-计费
                                   outPutReality:Math.floor(Math.random () * 4 + 1),//单车产出-实收
                               },
                               singleCost:{
                                   oBikeCost:Math.floor(Math.random () * 5 + 1),//单车成本
                               },
                               singleProfit:{
                                   inPutBilling:Math.floor(Math.random () * 5 + 1),//单车盈收-计费
                                   inPutReality:Math.floor(Math.random () * 6 + 1),//单车盈收-实收
                               },
                               singleProfitRate:{
                                   inPutBillingLv:Math.floor(Math.random () * 7 + 1),//单车盈收率-计费
                                   inPutRealityLv:Math.floor(Math.random () * 8 + 1),//单车盈收率-实收
                               }
                           }
                       )
                   }
                   return data
               },
               changePage() {
                   // 这里直接更改了模拟的数据，真实使用场景应该从服务端获取数据
                   var that =  this
                   setTimeout(function() {
                       console.log(that.dataMonth)
                       that.axios('/monthDataDetail/api/v1/monthDataDetail', {
                           params: {
                               dataMonth: that.dataMonth,
                               type: 4
                           }
                           }).then((response) => {
                               var data = response.data.data
                               var arr = [];
                               for (var i = 0; i < data.length; i++) {
                                   if (i <= data.length - 1) {
                                       arr.push(
                                            {
                                               cityName: data[i].city,
                                               singleProduce: {
                                                   outPutBilling: data[i].outPutBilling,//单车产出-计费
                                                   outPutReality: data[i].outPutReality,//单车产出-实收
                                               },
                                               singleCost: {
                                                   oBikeCost: data[i].oBikeCost,//单车成本
                                               },
                                               singleProfit: {
                                                   inPutBilling: data[i].inPutBilling,//单车盈收-计费
                                                   inPutReality: data[i].inPutReality,//单车盈收-实收
                                               },
                                               singleProfitRate: {
                                                   inPutBillingLv: data[i].inPutBillingLv,//单车盈收率-计费
                                                   inPutRealityLv: data[i].inPutRealityLv,//单车盈收率-实收
                                               }
                                           }
                                       )
                                   }
                                   if (i === data.length - 1) {
                                       this.countObj = data[data.length - 1]
                                   }
   
                               }
                               console.log(arr)
                               console.log(this.countObj)
                               that.data4 = arr
                               var html = ''
                               for (var i = 0; i < 1; i++) {
                                   html += `
                                       <tr class="ivu-table-row">
                                           <td class="middle ivu-table-hidden">
                                               <div class="ivu-table-cell ivu-table-hidden">
                                                   <div>北京市</div>
                                               </div>
                                           </td>
                                           <td class="ivu-table-column-center">
                                               <div class="ivu-table-cell">
                                                   <div style="height: 30px;"><span style="float: left; width: 50%; height: 30px; line-height: 30px; border-right: 1px solid rgb(233, 234, 236); box-sizing: border-box;">${countObj.outPutBilling}</span>
                                                       <span
                                                           style="float: left; width: 50%; height: 30px; line-height: 30px; border-right: none; box-sizing: border-box;">${countObj.outPutReality}</span>
                                                   </div>
                                               </div>
                                           </td>
                                           <td class="ivu-table-column-center">
                                               <div class="ivu-table-cell">
                                                   <div style="height: 30px;"><span style="float: left; width: 100%; height: 30px; line-height: 30px; box-sizing: border-box;">${countObj.oBikeCost}</span></div>
                                               </div>
                                           </td>
                                           <td class="ivu-table-column-center">
                                               <div class="ivu-table-cell">
                                                   <div style="height: 30px;"><span style="float: left; width: 50%; height: 30px; line-height: 30px; border-right: 1px solid rgb(233, 234, 236); box-sizing: border-box;">${countObj.inPutBilling}</span>
                                                       <span
                                                           style="float: left; width: 50%; height: 30px; line-height: 30px; border-right: none; box-sizing: border-box;">${countObj.inPutReality}</span>
                                                   </div>
                                               </div>
                                           </td>
                                           <td class="ivu-table-column-center">
                                               <div class="ivu-table-cell">
                                                   <div style="height: 30px;"><span style="float: left; width: 50%; height: 30px; line-height: 30px; border-right: 1px solid rgb(233, 234, 236); box-sizing: border-box;">${countObj.inPutBillingLv}</span>
                                                       <span
                                                           style="float: left; width: 50%; height: 30px; line-height: 30px; border-right: none; box-sizing: border-box;">${countObj.inPutRealityLv}</span>
                                                   </div>
                                               </div>
                                           </td>
                                       </tr>
                                   `
                               }
                              
                           if(that.data4.length>0){
                                   $('.ivu-table-body').eq(3).find('table').find('tfoot').remove()
                                   $('.ivu-table-body').eq(3).find('table').append("<tfoot><tr>" + html + "</tr></tfoot>")
                                   $('.ivu-tabs-tabpane').eq(3).find('.ivu-table-fixed').find('.ivu-table-fixed-body').find('table').find('tfoot').remove()
                                   $('.ivu-tabs-tabpane').eq(3).find('.ivu-table-fixed').find('.ivu-table-fixed-body').find('table').append('<tfoot><td class="middle"><div class="ivu-table-cell"><div>合计</div></div></td></tfoot>')
                                   $('.ivu-tabs-tabpane').eq(3).find('.ivu-table-fixed-right').find('.ivu-table-fixed-body').find('table').find('tfoot').remove()
                                   $('.ivu-tabs-tabpane').eq(3).find('.ivu-table-fixed-right').find('.ivu-table-fixed-body').find('table').append('<tfoot><tr class="ivu-table-row"><td class="middle"><div class="ivu-table-cell"><div>'+this.countObj.total+'</div></div></td></tr></tfoot>')
                               }else{
                                   $('.ivu-table-body').eq(3).find('table').find('tfoot').remove()
                                   $('.ivu-tabs-tabpane').eq(3).find('.ivu-table-fixed').find('.ivu-table-fixed-body').find('table').find('tfoot').remove()
                                   $('.ivu-tabs-tabpane').eq(3).find('.ivu-table-fixed-right').find('.ivu-table-fixed-body').find('table').find('tfoot').remove()
                               }
                           }).catch((error) => {
                               console.log(error)
                           })
                       }, 200)
               }
           },
           mounted(){
   //             var html = ''
   //             for(var i=0;i<1;i++){
   //                 html += `
   //                     <tr class="ivu-table-row">
   //     <td class="middle ivu-table-hidden">
   //         <div class="ivu-table-cell ivu-table-hidden">
   //             <!---->
   //             <!---->
   //             <!---->
   //             <!---->
   //             <div>北京市</div>
   //         </div>
   //     </td>
   //     <td class="ivu-table-column-center">
   //         <div class="ivu-table-cell">
   //             <!---->
   //             <!---->
   //             <!---->
   //             <!---->
   //             <div style="height: 30px;"><span style="float: left; width: 50%; height: 30px; line-height: 30px; border-right: 1px solid rgb(233, 234, 236); box-sizing: border-box;">0.00</span>
   //                 <span
   //                     style="float: left; width: 50%; height: 30px; line-height: 30px; border-right: none; box-sizing: border-box;">0.00</span>
   //             </div>
   //         </div>
   //     </td>
   //     <td class="ivu-table-column-center">
   //         <div class="ivu-table-cell">
   //             <!---->
   //             <!---->
   //             <!---->
   //             <!---->
   //             <div style="height: 30px;"><span style="float: left; width: 100%; height: 30px; line-height: 30px; box-sizing: border-box;">0.00</span></div>
   //         </div>
   //     </td>
   //     <td class="ivu-table-column-center">
   //         <div class="ivu-table-cell">
   //             <!---->
   //             <!---->
   //             <!---->
   //             <!---->
   //             <div style="height: 30px;"><span style="float: left; width: 50%; height: 30px; line-height: 30px; border-right: 1px solid rgb(233, 234, 236); box-sizing: border-box;">0.00</span>
   //                 <span
   //                     style="float: left; width: 50%; height: 30px; line-height: 30px; border-right: none; box-sizing: border-box;">0.00</span>
   //             </div>
   //         </div>
   //     </td>
   //     <td class="ivu-table-column-center">
   //         <div class="ivu-table-cell">
   //             <!---->
   //             <!---->
   //             <!---->
   //             <!---->
   //             <div style="height: 30px;"><span style="float: left; width: 50%; height: 30px; line-height: 30px; border-right: 1px solid rgb(233, 234, 236); box-sizing: border-box;">0</span>
   //                 <span
   //                     style="float: left; width: 50%; height: 30px; line-height: 30px; border-right: none; box-sizing: border-box;">0</span>
   //             </div>
   //         </div>
   //     </td>
   // </tr>
   //                 `
   //             }
   //             $('.ivu-table-body').eq(3).find('table').append("<tfoot><tr>" + html + "</tr></tfoot>")
   //             $('.ivu-tabs-tabpane').eq(3).find('.ivu-table-fixed').find('.ivu-table-fixed-body').find('table').append('<tfoot><td class="middle"><div class="ivu-table-cell"><div>合计</div></div></td></tfoot>')
   //             $('.ivu-tabs-tabpane').eq(3).find('.ivu-table-fixed-right').find('.ivu-table-fixed-body').find('table').append( '<tfoot><tr class="ivu-table-row"><td class="middle"><div class="ivu-table-cell"><div>6</div></div></td></tr></tfoot>')
              
           },
           watch: {
               'dataMonth': {
                   handler: function(val) {
                       this.changePage()
                   },
                   deep: true
               }
           }
       }
   </script>
   <style lang="scss" scoped type="text/css">
   div.ivu-table-wrapper{margin:0 auto;}
   div.fiexedAssets{padding:0 16px 16px 16px;}
   </style>
   
   